{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/teranyan/workspace/OrangeJuiceWeb/src/templates/home.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { useCallback, useState } from 'react';\nimport authState from '~/stores/auth';\nimport { useRecoilValue } from 'recoil';\nimport firebase from '~/modules/firebase';\nimport 'firebase/functions';\n\nvar Template = function Template() {\n  _s();\n\n  var uid = useRecoilValue(authState);\n\n  var _useState = useState(''),\n      email = _useState[0],\n      setEmail = _useState[1];\n\n  var _useState2 = useState(''),\n      password = _useState2[0],\n      setPassword = _useState2[1];\n\n  var signIn = useCallback(function () {\n    firebase.auth().signInWithEmailAndPassword(email, password);\n  }, [email, password]);\n  var getToken = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var res, serializedCookie;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return firebase.functions(\"asia-northeast1\").httpsCallable(\"http-sessionCookie\")();\n\n          case 2:\n            res = _context.sent;\n            serializedCookie = cookie.serialize(\"Cloud-CDN-Cookie\", res.data.token, {\n              domain: res.data.domain,\n              path: res.data.path,\n              expires: new Date(res.data.expires),\n              httpOnly: true,\n              secure: true\n            });\n            nookies.set();\n            document.cookie = serializedCookie;\n            console.log(serializedCookie);\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: uid ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: getToken,\n        children: \"get token\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 23,\n        columnNumber: 3\n      }, _this), /*#__PURE__*/_jsxDEV(\"audio\", {\n        controls: true,\n        children: /*#__PURE__*/_jsxDEV(\"source\", {\n          src: \"https://media.orange-juice.app/video/private/XCfWJkbGGvT08umQBaMl5ufL10u2/test.mp3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 25,\n          columnNumber: 5\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 24,\n        columnNumber: 3\n      }, _this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"mail\",\n        placeholder: \"mail\",\n        onChange: function onChange(e) {\n          return setEmail(e.target.value);\n        },\n        value: email\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 3\n      }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        placeholder: \"password\",\n        onChange: function onChange(e) {\n          return setPassword(e.target.value);\n        },\n        value: password\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 29,\n        columnNumber: 3\n      }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: signIn,\n        children: \"signin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 3\n      }, _this)]\n    }, void 0, true)\n  }, void 0, false);\n};\n\n_s(Template, \"4YAQJBkyi1DqzqeVdVCF3FbqHt0=\", false, function () {\n  return [useRecoilValue];\n});\n\n_c = Template;\nexport default Template;\n\nvar _c;\n\n$RefreshReg$(_c, \"Template\");","map":{"version":3,"sources":["/Users/teranyan/workspace/OrangeJuiceWeb/src/templates/home.tsx"],"names":["useCallback","useState","authState","useRecoilValue","firebase","Template","uid","email","setEmail","password","setPassword","signIn","auth","signInWithEmailAndPassword","getToken","functions","httpsCallable","res","serializedCookie","cookie","serialize","data","token","domain","path","expires","Date","httpOnly","secure","nookies","set","document","console","log","e","target","value"],"mappings":"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","sourcesContent":["import { FC, useCallback, useState } from 'react'\nimport authState from '~/stores/auth'\nimport { useRecoilValue } from 'recoil'\nimport firebase from '~/modules/firebase'\nimport 'firebase/functions'\nimport {setCookie} from 'nookies'\n\nconst Template: FC = () => {\n  const uid = useRecoilValue(authState)\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const signIn = useCallback(()=>{\n    firebase.auth().signInWithEmailAndPassword(email, password);\n  },[email, password])\n  const getToken = useCallback(async ()=>{\n    const res = await firebase.functions(\"asia-northeast1\").httpsCallable(\"http-sessionCookie\")()\n    const serializedCookie = cookie.serialize(\"Cloud-CDN-Cookie\", res.data.token, { domain: res.data.domain, path: res.data.path, expires: new Date(res.data.expires), httpOnly: true, secure: true})\n    nookies.set()\n    document.cookie = serializedCookie\n    console.log(serializedCookie)\n  },[])\n  return <>{uid ? <>\n  <button onClick={getToken}>get token</button>\n  <audio  controls>\n    <source src=\"https://media.orange-juice.app/video/private/XCfWJkbGGvT08umQBaMl5ufL10u2/test.mp3\" />\n  </audio>\n   </> : <>\n  <input type=\"mail\" placeholder=\"mail\" onChange={e=>setEmail(e.target.value)} value={email}/>\n  <input type=\"password\" placeholder=\"password\" onChange={e=>setPassword(e.target.value)} value={password}/>\n  <button onClick={signIn}>signin</button>\n  </>}</>\n} \n\nexport default Template"]},"metadata":{},"sourceType":"module"}